# å¿…è¯»ï¼ï¼ï¼
# ä¼˜åŒ–é‡ç‚¹ï¼šç§»é™¤äº†éš¾æ‡‚çš„é”šç‚¹ï¼Œä½¿ç”¨äº† CDN åŠ é€Ÿè§„åˆ™ä¸‹è½½ï¼Œé›†æˆè‡ªå®šä¹‰ GitHub è§„åˆ™ã€‚

# 1. æœºåœºè®¢é˜…
proxy-providers:
  Qingyun:
    url: "~"
    type: http
    interval: 86400
    health-check:
      enable: true
      url: https://www.gstatic.com/generate_204
      interval: 300
    proxy: ç›´è¿
  Yesha:
    url: "~"
    type: http
    interval: 86400
    health-check:
      enable: true
      url: https://www.gstatic.com/generate_204
      interval: 300
    proxy: ç›´è¿

# 2. é™æ€èŠ‚ç‚¹
proxies:
  - {name: ç›´è¿, type: direct}

# 3. å…¨å±€é…ç½®
allow-lan: true
bind-address: "*"
ipv6: false
unified-delay: true
tcp-concurrent: true
log-level: info
mode: rule
find-process-mode: 'off'
global-client-fingerprint: chrome
keep-alive-idle: 600
keep-alive-interval: 15

profile:
  store-selected: true
  store-fake-ip: true

# 4. å—…æ¢è®¾ç½®
sniffer:
  enable: true
  parse-pure-ip: true
  sniff:
    HTTP:
      ports: [80, 8080-8880]
      override-destination: true
    TLS:
      ports: [443, 8443]
    QUIC:
      ports: [443, 8443]
  skip-domain:
    - "Mijia Cloud"
    - "+.push.apple.com"

# 5. å…¥ç«™è®¾ç½® (TUNæ¨¡å¼)
tun:
  enable: true
  stack: system # x86 æ€§èƒ½è¶³å¤Ÿï¼Œsystem å…¼å®¹æ€§æœ€å¥½
  dns-hijack: ["any:53", "tcp://any:53"]
  auto-route: false
  auto-redirect: false
  auto-detect-interface: false

# 6. DNS è®¾ç½® (Fake-IP æ¨¡å¼)
dns:
  enable: true
  prefer-h3: true
  cache-algorithm: arc
  listen: 0.0.0.0:1053
  ipv6: false
  respect-rules: true
  enhanced-mode: fake-ip
  fake-ip-range: 198.18.0.1/16
  fake-ip-filter-mode: blacklist

  # Fake-IP è¿‡æ»¤åå•
  fake-ip-filter:
    # å¼•ç”¨ä¸‹æ–¹å®šä¹‰çš„è§„åˆ™é›† (Clash Meta ç‰¹æ€§)
    - rule-set:fakeipfilter_public
    # å¼•ç”¨ä½ è‡ªå·± GitHub ä¸Šçš„ FakeIP è¿‡æ»¤æ–‡ä»¶ (éœ€è¦åœ¨ rule-providers å®šä¹‰)
    #- rule-set:my_fakeip_filter
    - "+.lan"
    - "+.local"

  default-nameserver:
    - 223.5.5.5
    - 119.29.29.29

  direct-nameserver:
    - https://dns.alidns.com/dns-query
    - https://doh.pub/dns-query

  nameserver:
    - https://8.8.8.8/dns-query
    - https://1.1.1.1/dns-query

  proxy-server-nameserver:
    - https://dns.alidns.com/dns-query
    - https://doh.pub/dns-query

# 7. ç­–ç•¥ç»„
proxy-groups:
  # ä¸»å¼€å…³
  - name: ğŸš€ èŠ‚ç‚¹é€‰æ‹©
    type: select
    proxies: [â™»ï¸ è‡ªåŠ¨é€‰æ‹©, ğŸ‡­ğŸ‡° é¦™æ¸¯èŠ‚ç‚¹, ğŸ‡¨ğŸ‡³ å°æ¹¾èŠ‚ç‚¹, ğŸ‡¯ğŸ‡µ æ—¥æœ¬èŠ‚ç‚¹, ğŸ‡¸ğŸ‡¬ ç‹®åŸèŠ‚ç‚¹, ğŸ‡ºğŸ‡² ç¾å›½èŠ‚ç‚¹, ğŸŒ å…¨éƒ¨èŠ‚ç‚¹, ç›´è¿]

  # åœºæ™¯ç­–ç•¥
  - name: ğŸ¤– äººå·¥æ™ºèƒ½
    type: select
    proxies: [ğŸ‡ºğŸ‡² ç¾å›½èŠ‚ç‚¹, ğŸ‡¯ğŸ‡µ æ—¥æœ¬èŠ‚ç‚¹, ğŸ‡¸ğŸ‡¬ ç‹®åŸèŠ‚ç‚¹, ğŸš€ èŠ‚ç‚¹é€‰æ‹©]

  - name: ğŸ“º å›½é™…åª’ä½“
    type: select
    proxies: [ğŸš€ èŠ‚ç‚¹é€‰æ‹©, â™»ï¸ è‡ªåŠ¨é€‰æ‹©, ğŸ‡­ğŸ‡° é¦™æ¸¯èŠ‚ç‚¹, ğŸ‡¨ğŸ‡³ å°æ¹¾èŠ‚ç‚¹, ğŸ‡¯ğŸ‡µ æ—¥æœ¬èŠ‚ç‚¹, ğŸ‡¸ğŸ‡¬ ç‹®åŸèŠ‚ç‚¹, ğŸ‡ºğŸ‡² ç¾å›½èŠ‚ç‚¹]

  - name: ğŸ“² å³æ—¶é€šè®¯
    type: select
    proxies: [ğŸš€ èŠ‚ç‚¹é€‰æ‹©, â™»ï¸ è‡ªåŠ¨é€‰æ‹©, ğŸ‡­ğŸ‡° é¦™æ¸¯èŠ‚ç‚¹, ğŸ‡¨ğŸ‡³ å°æ¹¾èŠ‚ç‚¹, ğŸ‡¯ğŸ‡µ æ—¥æœ¬èŠ‚ç‚¹, ğŸ‡¸ğŸ‡¬ ç‹®åŸèŠ‚ç‚¹, ğŸ‡ºğŸ‡² ç¾å›½èŠ‚ç‚¹]

  - name: ğŸ¯ Explorer
    type: select
    proxies: [ğŸ‡­ğŸ‡° é¦™æ¸¯èŠ‚ç‚¹, ğŸ‡¨ğŸ‡³ å°æ¹¾èŠ‚ç‚¹, ğŸ‡¸ğŸ‡¬ ç‹®åŸèŠ‚ç‚¹, ğŸ‡ºğŸ‡² ç¾å›½èŠ‚ç‚¹]

  # è‡ªåŠ¨é€‰æ‹©ä¸ç­›é€‰
  - name: â™»ï¸ è‡ªåŠ¨é€‰æ‹©
    type: url-test
    url: "http://www.gstatic.com/generate_204"
    interval: 300
    tolerance: 50
    include-all: true
    filter: "^(?!.*(ç½‘å€|å‘å¸ƒ|ç›´è¿|å‰©ä½™|åˆ°æœŸ|è¿‡æœŸ|å®˜ç½‘|æ›´æ–°|ç¾¤|æ¸¸æˆ)).*$"

  - {name: ğŸ‡¨ğŸ‡³ å°æ¹¾èŠ‚ç‚¹, type: select, include-all: true, filter: "(?i)(å°|TW|Taiwan)"}
  - {name: ğŸ‡­ğŸ‡° é¦™æ¸¯èŠ‚ç‚¹, type: select, include-all: true, filter: "(?i)(æ¸¯|HK|Hong Kong)"}
  - {name: ğŸ‡¯ğŸ‡µ æ—¥æœ¬èŠ‚ç‚¹, type: select, include-all: true, filter: "(?i)(æ—¥|JP|Japan)"}
  - {name: ğŸ‡ºğŸ‡² ç¾å›½èŠ‚ç‚¹, type: select, include-all: true, filter: "(?i)(ç¾|US|States)"}
  - {name: ğŸ‡¸ğŸ‡¬ ç‹®åŸèŠ‚ç‚¹, type: select, include-all: true, filter: "(?i)(æ–°åŠ |å¡|SG|Singapore)"}
  - {name: ğŸŒ å…¨éƒ¨èŠ‚ç‚¹, type: select, include-all: true, filter: "^(?!.*(ç½‘å€|å‘å¸ƒ|ç›´è¿|å‰©ä½™|åˆ°æœŸ|è¿‡æœŸ|å®˜ç½‘|æ›´æ–°|ç¾¤|æ¸¸æˆ)).*$"}

  - name: ğŸŸ æ¼ç½‘ä¹‹é±¼
    type: select
    proxies: [ğŸš€ èŠ‚ç‚¹é€‰æ‹©, ç›´è¿]

# 8. åˆ†æµè§„åˆ™é€»è¾‘
# --- å¿…é¡»ä¼˜å…ˆå¤„ç†çš„è§„åˆ™ ---
# å¼•ç”¨ä½ è‡ªå·±çš„ GitHub åˆ†æµè§„åˆ™ (å¯¹åº”ä¸‹æ–¹ rule-providers çš„åå­—)
# - RULE-SET,my_custom_domain,ğŸš€ èŠ‚ç‚¹é€‰æ‹©
rules:

  # å±€åŸŸç½‘ä¸ç›´è¿
  - RULE-SET,private_ip,ç›´è¿,no-resolve
  - RULE-SET,private_domain,ç›´è¿
  - RULE-SET,apple_domain,ç›´è¿
  - RULE-SET,apple_ip,ç›´è¿
  - RULE-SET,speedtest_domain,ç›´è¿
  - RULE-SET,paypal_domain,ç›´è¿
  - RULE-SET,cn_domain,ç›´è¿
  - RULE-SET,cn_ip,ç›´è¿

  # --- ä»£ç†è§„åˆ™ ---
  - RULE-SET,ai,ğŸ¤– äººå·¥æ™ºèƒ½
  - RULE-SET,youtube_domain,ğŸ“º å›½é™…åª’ä½“
  - RULE-SET,netflix_domain,ğŸ“º å›½é™…åª’ä½“
  - RULE-SET,netflix_ip,ğŸ“º å›½é™…åª’ä½“
  - RULE-SET,tiktok_domain,ğŸ“º å›½é™…åª’ä½“
  - RULE-SET,telegram_domain,ğŸ“² å³æ—¶é€šè®¯
  - RULE-SET,telegram_ip,ğŸ“² å³æ—¶é€šè®¯
  - RULE-SET,whatsapp_domain,ğŸ“² å³æ—¶é€šè®¯
  - RULE-SET,github_domain,ğŸš€ èŠ‚ç‚¹é€‰æ‹©
  - RULE-SET,google_domain,ğŸš€ èŠ‚ç‚¹é€‰æ‹©
  - RULE-SET,google_ip,ğŸš€ èŠ‚ç‚¹é€‰æ‹©
  - RULE-SET,geolocation-!cn,ğŸš€ èŠ‚ç‚¹é€‰æ‹©
  - RULE-SET,javdb_domain,ğŸ¯ Explorer
  - RULE-SET,javbus_domain,ğŸ¯ Explorer

  # å…œåº•
  - MATCH,ğŸŸ æ¼ç½‘ä¹‹é±¼

# 9. è§„åˆ™é›†å®šä¹‰ (Rule Providers)
# å·²ç§»é™¤ rule-anchorï¼Œæ”¹ä¸ºç›´è§‚çš„å†™æ³•ï¼Œå¹¶æ›¿æ¢ä¸º CDN é“¾æ¥
# --- ä½ çš„è‡ªå®šä¹‰ GitHub æ–‡ä»¶ ---
# è¯·å°† [user] å’Œ [repo] æ›¿æ¢ä¸ºä½ çœŸå®çš„ç”¨æˆ·åå’Œä»“åº“å
# my_custom_domain:
#   type: http
#   behavior: domain
#   format: yaml
#   url: "https://cdn.jsdelivr.net/gh/[user]/[repo]@main/proxy-domain.yaml"
#   path: ./ruleset/my_custom_domain.yaml
#   interval: 86400

# my_fakeip_filter:
#   type: http
#   behavior: domain
#   format: yaml
#   url: "https://cdn.jsdelivr.net/gh/[user]/[repo]@main/fakeip-filter.yaml"
#   path: ./ruleset/my_fakeip_filter.yaml
#   interval: 86400
rule-providers:
  # --- å…¬å…±è§„åˆ™é›† (MetaCubeX) ---
  fakeipfilter_public:
    type: http
    behavior: domain
    format: mrs
    url: "https://cdn.jsdelivr.net/gh/wwqgtxx/clash-rules@release/fakeip-filter.mrs"
    path: ./ruleset/fakeipfilter_public.mrs
    interval: 86400

  private_domain:
    type: http
    behavior: domain
    format: mrs
    url: "https://cdn.jsdelivr.net/gh/MetaCubeX/meta-rules-dat@meta/geo/geosite/private.mrs"
    path: ./ruleset/private_domain.mrs
    interval: 86400

  cn_domain:
    type: http
    behavior: domain
    format: mrs
    url: "https://cdn.jsdelivr.net/gh/MetaCubeX/meta-rules-dat@meta/geo/geosite/cn.mrs"
    path: ./ruleset/cn_domain.mrs
    interval: 86400

  ai:
    type: http
    behavior: domain
    format: mrs
    url: "https://cdn.jsdelivr.net/gh/MetaCubeX/meta-rules-dat@meta/geo/geosite/category-ai-!cn.mrs"
    path: ./ruleset/ai.mrs
    interval: 86400

  youtube_domain:
    type: http
    behavior: domain
    format: mrs
    url: "https://cdn.jsdelivr.net/gh/MetaCubeX/meta-rules-dat@meta/geo/geosite/youtube.mrs"
    path: ./ruleset/youtube_domain.mrs
    interval: 86400

  google_domain:
    type: http
    behavior: domain
    format: mrs
    url: "https://cdn.jsdelivr.net/gh/MetaCubeX/meta-rules-dat@meta/geo/geosite/google.mrs"
    path: ./ruleset/google_domain.mrs
    interval: 86400

  github_domain:
    type: http
    behavior: domain
    format: mrs
    url: "https://cdn.jsdelivr.net/gh/MetaCubeX/meta-rules-dat@meta/geo/geosite/github.mrs"
    path: ./ruleset/github_domain.mrs
    interval: 86400

  telegram_domain:
    type: http
    behavior: domain
    format: mrs
    url: "https://cdn.jsdelivr.net/gh/MetaCubeX/meta-rules-dat@meta/geo/geosite/telegram.mrs"
    path: ./ruleset/telegram_domain.mrs
    interval: 86400

  whatsapp_domain:
    type: http
    behavior: domain
    format: mrs
    url: "https://cdn.jsdelivr.net/gh/MetaCubeX/meta-rules-dat@meta/geo/geosite/whatsapp.mrs"
    path: ./ruleset/whatsapp_domain.mrs
    interval: 86400

  netflix_domain:
    type: http
    behavior: domain
    format: mrs
    url: "https://cdn.jsdelivr.net/gh/MetaCubeX/meta-rules-dat@meta/geo/geosite/netflix.mrs"
    path: ./ruleset/netflix_domain.mrs
    interval: 86400

  paypal_domain:
    type: http
    behavior: domain
    format: mrs
    url: "https://cdn.jsdelivr.net/gh/MetaCubeX/meta-rules-dat@meta/geo/geosite/paypal.mrs"
    path: ./ruleset/paypal_domain.mrs
    interval: 86400

  apple_domain:
    type: http
    behavior: domain
    format: mrs
    url: "https://cdn.jsdelivr.net/gh/MetaCubeX/meta-rules-dat@meta/geo/geosite/apple.mrs"
    path: ./ruleset/apple_domain.mrs
    interval: 86400

  speedtest_domain:
    type: http
    behavior: domain
    format: mrs
    url: "https://cdn.jsdelivr.net/gh/MetaCubeX/meta-rules-dat@meta/geo/geosite/ookla-speedtest.mrs"
    path: ./ruleset/speedtest_domain.mrs
    interval: 86400

  tiktok_domain:
    type: http
    behavior: domain
    format: mrs
    url: "https://cdn.jsdelivr.net/gh/MetaCubeX/meta-rules-dat@meta/geo/geosite/tiktok.mrs"
    path: ./ruleset/tiktok_domain.mrs
    interval: 86400

  geolocation-!cn:
    type: http
    behavior: domain
    format: mrs
    url: "https://cdn.jsdelivr.net/gh/MetaCubeX/meta-rules-dat@meta/geo/geosite/geolocation-!cn.mrs"
    path: ./ruleset/geolocation-not-cn.mrs
    interval: 86400

  javbus_domain:
    type: http
    behavior: domain
    format: mrs
    url: "https://cdn.jsdelivr.net/gh/MetaCubeX/meta-rules-dat@meta/geo/geosite/javbus.mrs"
    path: ./ruleset/javbus.mrs
    interval: 86400

  javdb_domain:
    type: http
    behavior: domain
    format: mrs
    url: "https://cdn.jsdelivr.net/gh/MetaCubeX/meta-rules-dat@meta/geo/geosite/javdb.mrs"
    path: ./ruleset/javdb.mrs
    interval: 86400

  # --- IP è§„åˆ™ ---
  private_ip:
    type: http
    behavior: ipcidr
    format: mrs
    url: "https://cdn.jsdelivr.net/gh/MetaCubeX/meta-rules-dat@meta/geo/geoip/private.mrs"
    path: ./ruleset/private_ip.mrs
    interval: 86400

  cn_ip:
    type: http
    behavior: ipcidr
    format: mrs
    url: "https://cdn.jsdelivr.net/gh/MetaCubeX/meta-rules-dat@meta/geo/geoip/cn.mrs"
    path: ./ruleset/cn_ip.mrs
    interval: 86400

  google_ip:
    type: http
    behavior: ipcidr
    format: mrs
    url: "https://cdn.jsdelivr.net/gh/MetaCubeX/meta-rules-dat@meta/geo/geoip/google.mrs"
    path: ./ruleset/google_ip.mrs
    interval: 86400

  telegram_ip:
    type: http
    behavior: ipcidr
    format: mrs
    url: "https://cdn.jsdelivr.net/gh/MetaCubeX/meta-rules-dat@meta/geo/geoip/telegram.mrs"
    path: ./ruleset/telegram_ip.mrs
    interval: 86400

  netflix_ip:
    type: http
    behavior: ipcidr
    format: mrs
    url: "https://cdn.jsdelivr.net/gh/MetaCubeX/meta-rules-dat@meta/geo/geoip/netflix.mrs"
    path: ./ruleset/netflix_ip.mrs
    interval: 86400

  apple_ip:
    type: http
    behavior: ipcidr
    format: mrs
    url: "https://cdn.jsdelivr.net/gh/MetaCubeX/meta-rules-dat@meta/geo-lite/geoip/apple.mrs"
    path: ./ruleset/apple_ip.mrs
    interval: 86400
